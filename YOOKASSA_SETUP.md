# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ÆKassa

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ÆKassa –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–¥–ø–∏—Å–æ–∫ PRO:

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ÆKassa** (`src/lib/yookassa.ts`)
   - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–ª–∞—Ç–µ–∂–µ
   - –°–æ–∑–¥–∞–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è webhook'–æ–≤

2. **GraphQL API** (–Ω–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞):
   - `createPayment` - –º—É—Ç–∞—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞
   - `checkPaymentStatus` - –∑–∞–ø—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
   - –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ÆKassa –∏–¥—É—Ç —á–µ—Ä–µ–∑ –±—ç–∫–µ–Ω–¥

3. **Webhook endpoint**:
   - `POST /api/yookassa/webhook` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç –ÆKassa

4. **–°—Ç—Ä–∞–Ω–∏—Ü—ã**:
   - –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–ø–ª–∞—Ç—ã (`/payment`) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GraphQL
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã (`/payment/success-simple`)
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ (`/debug-payment`)

5. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ÆKassa

–í —Ñ–∞–π–ª–µ `src/lib/yookassa.ts` —É–∫–∞–∑–∞–Ω—ã –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:

```typescript
export const YOOKASSA_CONFIG = {
  shopId: '1141058',
  secretKey: 'test_WqZwj6VXGxXs7OUM2DUNjKBP_VHwFBv3Ag8WPf3b_6U',
  apiUrl: 'https://api.yookassa.ru/v3'
};
```

## üöÄ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã (—á–µ—Ä–µ–∑ GraphQL)

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ø–ª–∞–Ω** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/payment`
2. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤—ã–∑—ã–≤–∞–µ—Ç GraphQL –º—É—Ç–∞—Ü–∏—é** `createPayment`
3. **GraphQL —Ä–µ–∑–æ–ª–≤–µ—Ä —Å–æ–∑–¥–∞–µ—Ç –ø–ª–∞—Ç–µ–∂** —á–µ—Ä–µ–∑ –ÆKassa API –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
4. **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è URL –æ–ø–ª–∞—Ç—ã** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
5. **–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã –ÆKassa
6. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç** –∫–∞—Ä—Ç–æ–π –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ÆKassa
7. **–í–æ–∑–≤—Ä–∞—Ç** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Å–ø–µ—Ö–∞ `/payment/success-simple`
8. **Webhook** –æ—Ç –ÆKassa –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
9. **–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç PRO —Å—Ç–∞—Ç—É—Å

## üîó URL –¥–ª—è webhook

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç –ÆKassa –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ webhook URL –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ:

```
https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/api/yookassa/webhook
```

## üí∞ –¶–µ–Ω—ã

–¢–µ–∫—É—â–∏–µ —Ü–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã –≤ `src/lib/planLimits.ts`:

- **–ú–µ—Å—è—á–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞**: 400 ‚ÇΩ
- **–ì–æ–¥–æ–≤–∞—è –ø–æ–¥–ø–∏—Å–∫–∞**: 4000 ‚ÇΩ (—ç–∫–æ–Ω–æ–º–∏—è 17%)

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTP Basic Auth –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ API –ÆKassa
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–µ –∫–ª—é—á–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è webhook'–æ–≤ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ (–ø—Ä–µ—Ñ–∏–∫—Å `test_`) –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## üìã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –ÆKassa:

- **–£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞**: `4111 1111 1111 1111`
- **–û—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞**: `4000 0000 0000 0002`
- **CVV**: –ª—é–±–æ–π —Ç—Ä–µ—Ö–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
- **–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è**: –ª—é–±–∞—è –±—É–¥—É—â–∞—è –¥–∞—Ç–∞

## üîÑ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –±–æ–µ–≤—ã–µ –∫–ª—é—á–∏

–ö–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:

1. –ü–æ–ª—É—á–∏—Ç–µ –±–æ–µ–≤—ã–µ –∫–ª—é—á–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ÆKassa
2. –ó–∞–º–µ–Ω–∏—Ç–µ `test_` –∫–ª—é—á –Ω–∞ –±–æ–µ–≤–æ–π –≤ `src/lib/yookassa.ts`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook URL –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω –¥–æ–º–µ–Ω–µ
4. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –º–∞–≥–∞–∑–∏–Ω –≤ –ÆKassa

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ webhook URL –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ÆKassa
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –∏ Shop ID
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ÆKassa: 8 800 350-46-56

---

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ